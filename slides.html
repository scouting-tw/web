<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ²‰æµ¸å¼ç°¡å ± (å®Œç¾ä¿®æ­£ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 1. ç°¡å ±å®¹å™¨ï¼šæ”¹ç”¨ visibility æ§åˆ¶ï¼Œé¿å… display:none å°è‡´ iframe åœ¨æ‰‹æ©Ÿä¸æ¸²æŸ“ */
        #presentation-container {
            visibility: hidden; /* é è¨­ä¸å¯è¦‹ï¼Œä½†åœ¨ DOM ä¸­ä½”ä½ */
            position: fixed;
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%;
            background-color: black;
            z-index: 9999;
            opacity: 0;
            transition: opacity 0.5s ease; /* æ·¡å…¥æ•ˆæœï¼Œé¿å…çªå…€é»‘å± */
        }

        /* é¡¯ç¤ºç‹€æ…‹ */
        #presentation-container.active {
            visibility: visible;
            opacity: 1;
        }

        /* iframe è¨­å®š */
        #presentation-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* 2. é—œé–‰æŒ‰éˆ•ï¼šé è¨­é¡¯ç¤º (çµ¦æ‰‹æ©Ÿç”¨) */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 10000;
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 9999px;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* â˜… é—œéµ CSSï¼šåœ¨é›»è…¦ç‰ˆ (å¯¬åº¦å¤§æ–¼ 768px) éš±è—é—œé–‰æŒ‰éˆ• */
        @media (min-width: 768px) {
            .close-btn {
                display: none !important;
            }
        }

        /* 3. éš±è—çš„ YouTube */
        #music-player-container {
            position: absolute;
            top: -9999px;
            left: -9999px;
            width: 1px; height: 1px;
            opacity: 0;
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col items-center justify-center min-h-screen">

    <div id="start-screen" class="bg-white p-8 rounded-xl shadow-2xl text-center max-w-md w-11/12 transition-opacity duration-300">
        <h1 class="text-3xl font-bold mb-2 text-gray-800">æ²‰æµ¸å¼ç°¡å ±</h1>
        <p class="text-gray-500 mb-6">æ‰‹æ©Ÿ/é›»è…¦é€šç”¨ç‰ˆ</p>
        
        <button id="start-btn" onclick="startExperience()" 
                class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-8 rounded-full transition transform hover:scale-105 shadow-lg flex items-center justify-center gap-3 mx-auto w-full">
            <span>ğŸš€</span> é–‹å§‹æ¼”ç¤º
        </button>
        <p id="loading-text" class="mt-4 text-sm text-gray-400 animate-pulse">æ­£åœ¨è¼‰å…¥æ’­æ”¾å™¨...</p>
    </div>

    <div id="presentation-container">
        <button class="close-btn" onclick="exitExperience()">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
            é—œé–‰
        </button>
        
        <iframe 
            id="slide-frame"
            src="https://docs.google.com/presentation/d/e/2PACX-1vR2aXZ8qJ9_0_X_X_X_X/embed?start=false&loop=false&delayms=3000" 
            allowfullscreen="true" 
            mozallowfullscreen="true" 
            webkitallowfullscreen="true">
        </iframe>
    </div>

    <div id="music-player-container">
        <div id="yt-player"></div>
    </div>

    <script>
        // ================= è¨­å®šå€ =================
        const YOUTUBE_MUSIC_ID = "jfKfPfyJRdk"; // Lofi Hip Hop
        const MUSIC_VOLUME = 50; 
        // =========================================

        var player;
        var isPlayerReady = false;

        // è¼‰å…¥ YouTube API
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('yt-player', {
                height: '200', width: '200',
                videoId: YOUTUBE_MUSIC_ID,
                playerVars: { 'playsinline': 1, 'controls': 0, 'loop': 1, 'playlist': YOUTUBE_MUSIC_ID },
                events: { 'onReady': onPlayerReady }
            });
        }

        function onPlayerReady(event) {
            isPlayerReady = true;
            player.setVolume(MUSIC_VOLUME);
            const statusText = document.getElementById('loading-text');
            statusText.innerText = "ç³»çµ±å°±ç·’ï¼Œè«‹é»æ“Šé–‹å§‹";
            statusText.className = "mt-4 text-sm text-green-600 font-bold";
        }

        // ====== é–‹å§‹é«”é©— ======
        function startExperience() {
            if (!isPlayerReady) { alert("éŸ³æ¨‚è¼‰å…¥ä¸­ï¼Œè«‹ç¨å¾Œ..."); return; }

            // 1. éš±è—ä¸»ç•«é¢ (æ·¡å‡º)
            document.getElementById('start-screen').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('start-screen').style.display = 'none';
            }, 300);

            // 2. é¡¯ç¤ºç°¡å ±å®¹å™¨ (æ·¡å…¥ + å•Ÿå‹• Active Class)
            const container = document.getElementById('presentation-container');
            container.classList.add('active'); // åŠ å…¥ class ä¾†è§¸ç™¼ visibility: visible

            // 3. å˜—è©¦é€²å…¥å…¨è¢å¹• (é›»è…¦ç‰ˆ)
            if (container.requestFullscreen) container.requestFullscreen().catch(e => {});
            else if (container.webkitRequestFullscreen) container.webkitRequestFullscreen();

            // 4. æ’­æ”¾éŸ³æ¨‚
            player.playVideo();

            // 5. ç¶å®š Esc ç›£è½
            setupExitListener();
        }

        // ====== é€€å‡ºé«”é©— ======
        function exitExperience() {
            // å˜—è©¦é€€å‡ºç€è¦½å™¨å…¨è¢å¹•
            if (document.fullscreenElement || document.webkitIsFullScreen) {
                if (document.exitFullscreen) document.exitFullscreen();
                else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
            }
            // ç„¡è«–æ˜¯å¦æœ‰å…¨è¢å¹•ï¼Œéƒ½åŸ·è¡Œ UI å¾©åŸ
            cleanupUI();
        }

        // å¾©åŸ UI
        function cleanupUI() {
            // æš«åœéŸ³æ¨‚
            if (player && typeof player.pauseVideo === 'function') {
                player.pauseVideo();
            }

            // éš±è—ç°¡å ±
            const container = document.getElementById('presentation-container');
            container.classList.remove('active'); // ç§»é™¤ classï¼Œè®Šå› hidden

            // é¡¯ç¤ºä¸»ç•«é¢
            const startScreen = document.getElementById('start-screen');
            startScreen.style.display = 'block';
            // çµ¦ä¸€é»æ™‚é–“è®“ display:block ç”Ÿæ•ˆå¾Œå†æ·¡å…¥
            setTimeout(() => {
                startScreen.style.opacity = '1';
            }, 50);
        }

        // ç›£è½ Esc
        function setupExitListener() {
            document.addEventListener('fullscreenchange', handleEscCheck);
            document.addEventListener('webkitfullscreenchange', handleEscCheck);
        }

        function handleEscCheck() {
            if (!document.fullscreenElement && !document.webkitIsFullScreen) {
                cleanupUI();
            }
        }
    </script>
</body>
</html>