<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ²‰æµ¸å¼ç°¡å ± (æ‰‹æ©Ÿä¿®å¾©ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 1. ç°¡å ±å®¹å™¨ï¼šæ”¹ç”¨ position: fixed å¼·åˆ¶è“‹ç‰ˆ 
           z-index è¨­å¾ˆé«˜ï¼Œç¢ºä¿è“‹ä½åŸæœ¬çš„å…§å®¹
        */
        #presentation-container {
            display: none; 
            position: fixed; /* é—œéµä¿®æ”¹ï¼šå›ºå®šå®šä½ */
            top: 0; 
            left: 0; 
            width: 100vw;    /* å¯¬åº¦ä½”æ»¿è¦–çª— */
            height: 100vh;   /* é«˜åº¦ä½”æ»¿è¦–çª— */
            background-color: black;
            z-index: 9999;   /* ç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
        }

        /* iframe è¨­å®š */
        #presentation-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* 2. æ‰‹æ©Ÿç‰ˆå¿…å‚™ï¼šè‡ªè¨‚é—œé–‰æŒ‰éˆ• 
           å› ç‚ºæ‰‹æ©Ÿæ²’æœ‰ Esc éµï¼Œéœ€è¦é€™å€‹æŒ‰éˆ•ä¾†å¾©åŸ
        */
        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10000;
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 50px;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            backdrop-filter: blur(4px);
        }

        /* 3. éš±è—çš„ YouTube æ’­æ”¾å™¨ */
        #music-player-container {
            position: absolute;
            top: -9999px;
            left: -9999px;
            width: 1px; 
            height: 1px;
            opacity: 0;
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col items-center justify-center min-h-screen">

    <div id="start-screen" class="bg-white p-8 rounded-xl shadow-2xl text-center max-w-md w-11/12">
        <h1 class="text-3xl font-bold mb-2 text-gray-800">æ²‰æµ¸å¼ç°¡å ±</h1>
        <p class="text-gray-500 mb-6">æ‰‹æ©Ÿ/é›»è…¦é€šç”¨ç‰ˆ</p>
        
        <button id="start-btn" onclick="startExperience()" 
                class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-8 rounded-full transition transform hover:scale-105 shadow-lg flex items-center justify-center gap-3 mx-auto w-full">
            <span>ğŸš€</span> é–‹å§‹æ¼”ç¤º
        </button>
        <p id="loading-text" class="mt-4 text-sm text-gray-400">æ­£åœ¨è¼‰å…¥æ’­æ”¾å™¨...</p>
    </div>

    <div id="presentation-container">
        <button class="close-btn" onclick="exitExperience()">âœ• é—œé–‰</button>
        
        <iframe 
            id="slide-frame"
            src="https://docs.google.com/presentation/d/e/2PACX-1vR2aXZ8qJ9_0_X_X_X_X/embed?start=false&loop=false&delayms=3000" 
            allowfullscreen="true" 
            mozallowfullscreen="true" 
            webkitallowfullscreen="true">
        </iframe>
    </div>

    <div id="music-player-container">
        <div id="yt-player"></div>
    </div>

    <script>
        // ================= è¨­å®šå€ =================
        const YOUTUBE_MUSIC_ID = "jfKfPfyJRdk"; // Lofi Hip Hop
        const MUSIC_VOLUME = 50; 
        // =========================================

        var player;
        var isPlayerReady = false;

        // è¼‰å…¥ YouTube API
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('yt-player', {
                height: '200', width: '200',
                videoId: YOUTUBE_MUSIC_ID,
                playerVars: { 'playsinline': 1, 'controls': 0, 'loop': 1, 'playlist': YOUTUBE_MUSIC_ID },
                events: { 'onReady': onPlayerReady }
            });
        }

        function onPlayerReady(event) {
            isPlayerReady = true;
            player.setVolume(MUSIC_VOLUME);
            document.getElementById('loading-text').innerText = "ç³»çµ±å°±ç·’ï¼Œè«‹é»æ“Šé–‹å§‹";
            document.getElementById('loading-text').className = "mt-4 text-sm text-green-600 font-bold";
        }

        // ====== æ ¸å¿ƒåŠŸèƒ½ï¼šé–‹å§‹é«”é©— ======
        function startExperience() {
            if (!isPlayerReady) { alert("éŸ³æ¨‚è¼‰å…¥ä¸­ï¼Œè«‹ç¨å¾Œ..."); return; }

            // 1. éš±è—é–‹å§‹ç•«é¢ (è§£æ±ºæ‰‹æ©Ÿç‰ˆè¢«é®æ“‹çš„å•é¡Œ)
            document.getElementById('start-screen').style.display = 'none';

            // 2. é¡¯ç¤ºç°¡å ±å®¹å™¨ (ä½”æ»¿å…¨è¢å¹•)
            const container = document.getElementById('presentation-container');
            container.style.display = 'block';

            // 3. å˜—è©¦é€²å…¥ç€è¦½å™¨å…¨è¢å¹• (é›»è…¦ç‰ˆæœ‰æ•ˆï¼Œæ‰‹æ©Ÿç‰ˆå¯èƒ½ç„¡æ•ˆä½†æ²’é—œä¿‚ï¼Œå› ç‚ºæˆ‘å€‘ç”¨äº† fixed css)
            if (container.requestFullscreen) container.requestFullscreen().catch(e => {});
            else if (container.webkitRequestFullscreen) container.webkitRequestFullscreen();

            // 4. æ’­æ”¾éŸ³æ¨‚
            player.playVideo();

            // 5. ç¶å®š Esc ç›£è½ (çµ¦é›»è…¦ç‰ˆç”¨)
            setupExitListener();
        }

        // ====== æ ¸å¿ƒåŠŸèƒ½ï¼šé€€å‡ºé«”é©— (æ‰‹å‹•æŒ‰éˆ•æˆ– Esc) ======
        function exitExperience() {
            // 1. é€€å‡ºç€è¦½å™¨å…¨è¢å¹•
            if (document.fullscreenElement || document.webkitIsFullScreen) {
                if (document.exitFullscreen) document.exitFullscreen();
                else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
            }

            // 2. åŸ·è¡Œæ¸…ç†å·¥ä½œ
            cleanupUI();
        }

        // çœŸæ­£çš„ UI å¾©åŸé‚è¼¯
        function cleanupUI() {
            // æš«åœéŸ³æ¨‚
            if (player && typeof player.pauseVideo === 'function') {
                player.pauseVideo();
            }

            // éš±è—ç°¡å ±ï¼Œé¡¯ç¤ºé–‹å§‹ç•«é¢
            document.getElementById('presentation-container').style.display = 'none';
            document.getElementById('start-screen').style.display = 'block'; // é—œéµï¼šæŠŠä¸»ç•«é¢å«å›ä¾†
        }

        // ç›£è½ Esc éµ (é›»è…¦ç‰ˆ)
        function setupExitListener() {
            document.addEventListener('fullscreenchange', handleEscCheck);
            document.addEventListener('webkitfullscreenchange', handleEscCheck);
        }

        function handleEscCheck() {
            // å¦‚æœåµæ¸¬åˆ°é€€å‡ºå…¨è¢å¹•ï¼Œå°±åŸ·è¡Œæ¸…ç†
            if (!document.fullscreenElement && !document.webkitIsFullScreen) {
                cleanupUI();
            }
        }
    </script>
</body>
</html>